<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Problem1</title>
    <script src="https://d3js.org/d3.v5.js"></script>
    <style>
        .middle_margin_10 {
            margin-top: 10%;
            text-align: center;
        }

        .middle_margin_2 {
            margin-top: 2%;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="middle_margin_10">

</div>

<div class="middle_margin_2">
    <button onclick="choose_problem(1)">problem1</button>
    <button onclick="choose_problem(2)">problem2</button>
    <button onclick="choose_problem(3)">problem3</button>
</div>


<script>
    function choose_problem(idx) {
        for (let i = 1; i < 4; i++) {
            if (i !== idx)
                d3.select(`#p${i}`).style("visibility", "hidden");
            else
                d3.select(`#p${i}`).style("visibility", "visible");
        }
    }

</script>

<script>
    const dataBaseLine = [
        {month: "Jan", baseline: 12.29},
        {month: "Feb", baseline: 12.50},
        {month: "Mar", baseline: 13.11},
        {month: "Apr", baseline: 14.03},
        {month: "May", baseline: 15.01},
        {month: "Jun", baseline: 15.72},
        {month: "Jul", baseline: 15.99},
        {month: "Aug", baseline: 15.82},
        {month: "Sep", baseline: 15.23},
        {month: "Oct", baseline: 14.30},
        {month: "Nov", baseline: 13.28},
        {month: "Dec", baseline: 12.55}
    ]

    const width = 800;
    const height = 400;

    const svg = d3
        .select("div")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .attr("id", "p1");

    svg
        .append("rect")
        .attr("width", width)
        .attr("height", height)
        .attr("fill", "white")
        .attr("stroke", "black")
        .attr("stroke-width", "3")

    const margin = {top: 80, right: 30, bottom: 50, left: 50};
    const g = svg.append("g").attr("transform", `translate(${margin.left}, ${margin.top})`);

    const gW = width - margin.left - margin.right;
    const gH = height - margin.top - margin.bottom;

    // Title
    svg.append("text")
        .attr("transform", `translate(${margin.left + gW / 2}, ${margin.top / 2})`)
        .style("font-family", "sans-serif")
        .style("font-size", "28px")
        .style("fill", "brown")
        .style("text-anchor", "middle")
        .style("font-weight", "bold")
        .text("Month - Baseline")

    // X axis
    const xScale = d3.scaleBand().range([0, gW]);
    xScale.domain(dataBaseLine.map(item => item.month));
    g.append("g")
        .attr("transform", `translate(0, ${gH})`)
        .call(d3.axisBottom(xScale).ticks())
        .attr("stroke", "darkred");
    svg.append("text")
        .attr("transform", `translate(${margin.left + gW / 2}, ${height - margin.bottom / 4})`)
        .style("font-family", "sans-serif")
        .style("font-size", "14px")
        .style("fill", "brown")
        .style("text-anchor", "middle")
        .style("font-weight", "bold")
        .text("Month")

    // Y axis
    const yScale = d3.scaleLinear().range([gH, 0]);
    yScale.domain([0, Math.ceil(d3.max(dataBaseLine, item => item.baseline))]);
    g.append("g")
        .call(d3.axisLeft(yScale))
        .attr("stroke", "darkred");
    svg.append("text")
        .attr("transform", `translate(${margin.left}, ${margin.top * 3 / 4})`)
        .style("font-family", "sans-serif")
        .style("font-size", "14px")
        .style("fill", "brown")
        .style("text-anchor", "middle")
        .style("font-weight", "bold")
        .text("Baseline")

    console.log(g.selectAll(".group-circle-text"));
    const symbols = g
        .selectAll(".group-circle-text")
        .data(dataBaseLine)
        .join("g")
        .attr("class", "group-circle-text");

    symbols
        .selectAll("circle")
        .data(dataBaseLine)
        .join("circle")
        .attr("cx", d => xScale(d.month) + xScale.bandwidth() / 2)
        .attr("cy", d => yScale(d.baseline))
        .attr("r", 3)
        .attr("fill", "red");

    symbols
        .selectAll("text")
        .data(dataBaseLine)
        .join("text")
        .style("font-family", "Arial")
        .style("font-size", "14px")
        .attr("x", d => xScale(d.month) + xScale.bandwidth() / 2 - 13)
        .attr("y", d => yScale(d.baseline) + 20)
        .text(d => d.baseline);

    const line = d3.line()
        .x(d => xScale(d.month) + xScale.bandwidth() / 2)
        .y(d => yScale(d.baseline))
        .curve(d3.curveCatmullRom);

    g.append("path")
        .attr("d", line(dataBaseLine))
        .attr("fill", "none")
        .attr("stroke", "coral")
        .attr("stroke-width", "2");
</script>

</body>
</html>
